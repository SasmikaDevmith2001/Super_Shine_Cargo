---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
---

<Layout title="Contact Us - Super Shine Cargo" description="Get in touch with Super Shine Cargo for all your logistics needs. Contact us for quotes, inquiries, and customer support">
  <Header />

  <!-- Hero Section -->
  <section class="page-hero">
    <div class="hero-overlay"></div>
    <div class="container">
      <div class="hero-content">
        <h1 class="hero-title">Contact</h1>
      </div>
    </div>
  </section>

  <main style="padding-top: 80px;">
    <!-- Hero Section -->
    <section class="contact-hero section">
      <div class="container">
        <h1 class="section-title">Contact Us</h1>
        <p class="section-subtitle">
          Ready to ship your cargo? Get in touch with our expert team for personalized logistics solutions
        </p>
      </div>
    </section>

    <!-- Contact Form & Info Section -->
    <section class="section contact-main">
      <div class="container">
        <div class="contact-content">
          <!-- Contact Form -->
          <div class="contact-form-section">
            <h2>Send Us a Message</h2>
            <p>Fill out the form below and we'll get back to you within 24 hours</p>
            
            <form class="contact-form" id="contact-form">
              <div class="form-row">
                <div class="form-group">
                  <label for="firstName">First Name *</label>
                  <input type="text" id="firstName" name="firstName" required>
                </div>
                <div class="form-group">
                  <label for="lastName">Last Name *</label>
                  <input type="text" id="lastName" name="lastName" required>
                </div>
              </div>
              
              <div class="form-row">
                <div class="form-group">
                  <label for="email">Email Address *</label>
                  <input type="email" id="email" name="email" required>
                </div>
                <div class="form-group">
                  <label for="phone">Phone Number</label>
                  <input type="tel" id="phone" name="phone">
                </div>
              </div>
              
              <div class="form-group">
                <label for="company">Company Name</label>
                <input type="text" id="company" name="company">
              </div>
              
              <div class="form-group">
                <label for="service">Service Required *</label>
                <select id="service" name="service" required>
                  <option value="">Select a service...</option>
                  <option value="import-export">Import & Export</option>
                  <option value="customs-clearance">Customs Clearance</option>
                  <option value="air-freight">Air Freight</option>
                  <option value="sea-freight">Sea Freight</option>
                  <option value="warehousing">Warehousing</option>
                  <option value="project-cargo">Project Cargo</option>
                  <option value="other">Other</option>
                </select>
              </div>
              
              <div class="form-row">
                <div class="form-group">
                  <label for="origin">Origin Country/Port</label>
                  <input type="text" id="origin" name="origin" placeholder="Where is your cargo coming from?">
                </div>
                <div class="form-group">
                  <label for="destination">Destination</label>
                  <input type="text" id="destination" name="destination" placeholder="Where is it going?">
                </div>
              </div>
              
              <div class="form-group">
                <label for="cargoDetails">Cargo Details</label>
                <textarea id="cargoDetails" name="cargoDetails" rows="3" placeholder="Type of goods, weight, dimensions, etc."></textarea>
              </div>
              
              <div class="form-group">
                <label for="message">Additional Message *</label>
                <textarea id="message" name="message" rows="4" placeholder="Tell us more about your requirements..." required></textarea>
              </div>
              
              <button type="submit" class="btn btn-primary form-submit">Send Message</button>
            </form>
          </div>

          <!-- Contact Information -->
          <div class="contact-info-section">
            <!-- ... your existing contact info & business hours ... -->
          </div>
        </div>
      </div>
    </section>

    <!-- Quick Contact Section -->
    <!-- ... your existing quick contact section ... -->

    <!-- FAQ Section -->
    <!-- ... your existing FAQ section ... -->

  </main>

  <Footer />
</Layout>

<style>
  .page-hero {
    min-height: 40vh;
    background-image: url('https://images.pexels.com/photos/3182812/pexels-photo-3182812.jpeg');
    background-size: cover;
    background-position: center;
    display: flex;
    align-items: center;
    position: relative;
    padding-top: 80px;
  }

  .hero-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(30, 64, 175, 0.8) 0%, rgba(59, 130, 246, 0.6) 100%);
  }

  .hero-content {
    position: relative;
    z-index: 1;
    text-align: center;
    color: white;
  }

  .hero-title {
    font-size: 3rem;
    font-weight: 700;
    margin: 0;
  }

  .contact-hero {
    background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
    padding: 4rem 0;
    text-align: center;
  }

  .contact-main {
    background: white;
  }

  .contact-content {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 4rem;
    align-items: flex-start;
  }

  .contact-form-section h2,
  .contact-info-section h2 {
    font-size: 1.75rem;
    font-weight: 600;
    color: #1E40AF;
    margin-bottom: 1rem;
  }

  .contact-form-section p,
  .contact-info-section p {
    color: #6b7280;
    margin-bottom: 2rem;
  }

  .contact-form {
    background: #f8fafc;
    padding: 2rem;
    border-radius: 1rem;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
  }

  .form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
  }

  .form-group {
    margin-bottom: 1.5rem;
  }

  .form-group label {
    display: block;
    font-weight: 500;
    color: #374151;
    margin-bottom: 0.5rem;
  }

  .form-group input,
  .form-group select,
  .form-group textarea {
    width: 100%;
    padding: 0.75rem;
    border: 2px solid #e5e7eb;
    border-radius: 0.5rem;
    font-size: 1rem;
    transition: border-color 0.3s ease;
  }

  .form-group input:focus,
  .form-group select:focus,
  .form-group textarea:focus {
    outline: none;
    border-color: #3B82F6;
  }

  .form-submit {
    width: 100%;
    padding: 1rem;
    font-size: 1.1rem;
    margin-top: 1rem;
  }

  .contact-methods {
    margin-bottom: 3rem;
  }

  .contact-method {
    display: flex;
    align-items: flex-start;
    gap: 1rem;
    margin-bottom: 2rem;
    padding: 1.5rem;
    background: #f8fafc;
    border-radius: 1rem;
    border-left: 4px solid #3B82F6;
  }

  .method-icon {
    width: 2rem;
    height: 2rem;
    color: #3B82F6;
    flex-shrink: 0;
  }

  .method-icon svg {
    width: 100%;
    height: 100%;
  }

  .method-content h3 {
    font-size: 1.125rem;
    font-weight: 600;
    color: #1E40AF;
    margin-bottom: 0.5rem;
  }

  .method-content p {
    color: #4b5563;
    margin: 0;
    line-height: 1.6;
  }

  .method-content a {
    color: #1E40AF;
    text-decoration: none;
  }

  .method-content a:hover {
    text-decoration: underline;
  }

  .business-hours {
    background: #f8fafc;
    padding: 2rem;
    border-radius: 1rem;
    border: 2px solid #e2e8f0;
  }

  .business-hours h3 {
    font-size: 1.25rem;
    font-weight: 600;
    color: #1E40AF;
    margin-bottom: 1rem;
  }

  .hours-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.5rem 0;
    border-bottom: 1px solid #e5e7eb;
  }

  .hours-item:last-child {
    border-bottom: none;
  }

  .hours-item.emergency {
    background: linear-gradient(135deg, #1E40AF 0%, #3B82F6 100%);
    color: white;
    padding: 0.75rem;
    border-radius: 0.5rem;
    margin-top: 1rem;
    border: none;
  }

  .quick-contact {
    background: #f8fafc;
  }

  .quick-contact-content {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 2rem;
  }

  .quick-contact-item {
    background: white;
    padding: 2rem;
    text-align: center;
    border-radius: 1rem;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    transition: transform 0.3s ease;
  }

  .quick-contact-item:hover {
    transform: translateY(-5px);
  }

  .quick-icon {
    width: 3rem;
    height: 3rem;
    color: #3B82F6;
    margin-bottom: 1rem;
  }

  .quick-icon svg {
    width: 100%;
    height: 100%;
  }

  .quick-contact-item h3 {
    font-size: 1.25rem;
    font-weight: 600;
    color: #1E40AF;
    margin-bottom: 0.5rem;
  }

  .quick-contact-item p {
    color: #6b7280;
    margin-bottom: 1.5rem;
  }

  .faq-section {
    background: white;
  }

  .faq-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
    gap: 2rem;
    margin-top: 3rem;
  }

  .faq-item {
    background: #f8fafc;
    padding: 2rem;
    border-radius: 1rem;
    border-left: 4px solid #3B82F6;
  }

  .faq-item h3 {
    font-size: 1.125rem;
    font-weight: 600;
    color: #1E40AF;
    margin-bottom: 1rem;
  }

  .faq-item p {
    color: #4b5563;
    line-height: 1.6;
    margin: 0;
  }

  @media (max-width: 768px) {
    .page-hero {
      background-attachment: scroll;
    }
    
    .contact-content {
      grid-template-columns: 1fr;
      gap: 2rem;
    }

    .form-row {
      grid-template-columns: 1fr;
    }

    .quick-contact-content {
      grid-template-columns: 1fr;
    }

    .faq-grid {
      grid-template-columns: 1fr;
    }

    .hero-title {
      font-size: 2rem;
    }
  }
</style>

<script>
  const form = document.getElementById('contact-form');

  form?.addEventListener('submit', async (e) => {
    e.preventDefault();

    const submitButton = form.querySelector('.form-submit');
    const originalText = submitButton.textContent;

    submitButton.textContent = 'Sending...';
    submitButton.disabled = true;

    const formData = Object.fromEntries(new FormData(form));
    const requiredFields = ['firstName', 'lastName', 'email', 'service', 'message'];

    for (const field of requiredFields) {
      if (!formData[field]) {
        alert('Please fill in all required fields.');
        submitButton.textContent = originalText;
        submitButton.disabled = false;
        return;
      }
    }

    const SUPABASE_URL = import.meta.env.VITE_SUPABASE_URL;
    const SUPABASE_KEY = import.meta.env.VITE_SUPABASE_ANON_KEY;

    if (!SUPABASE_URL || !SUPABASE_KEY) {
      alert('Configuration error. Supabase credentials not found.');
      console.error('Missing VITE_SUPABASE_URL or VITE_SUPABASE_ANON_KEY');
      submitButton.textContent = originalText;
      submitButton.disabled = false;
      return;
    }

    // Replace with your full Supabase Edge Function URL
    const functionUrl = 'https://lwcdhsakltnxolsxpjvb.supabase.co/functions/v1/send-contact-email';

    try {
      const response = await fetch(functionUrl, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${SUPABASE_KEY}`,
        },
        body: JSON.stringify(formData)
      });

      const result = await response.json();

      if (response.ok && result.success) {
        alert('Thank you for your message! We will get back to you within 24 hours.');
        form.reset();
      } else {
        console.error('Error response from function:', result);
        throw new Error(result.error || 'Failed to send message.');
      }

    } catch (err) {
      console.error('Fetch error:', err);
      alert('Sorry, there was an error sending your message. Please try again or contact us directly.');
    } finally {
      submitButton.textContent = originalText;
      submitButton.disabled = false;
    }
  });

  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
      e.preventDefault();
      const target = document.querySelector(this.getAttribute('href'));
      if (target) target.scrollIntoView({ behavior: 'smooth', block: 'start' });
    });
  });

  console.log("Supabase URL:", import.meta.env.VITE_SUPABASE_URL);
  console.log("Supabase Key:", import.meta.env.VITE_SUPABASE_ANON_KEY?.slice(0, 10) + "...");
</script>
